"0","#Pulling Crime Data (Thefts/Other Incidents Only)"
"0",""
"0","crime09 <- "
"0","  read.csv(""/Users/kmlum/OneDrive/Documents/FALL 2021/Public Policy Analytics/GitHub/TODassignment/Crime_Incidents_in_2009.csv"", header = TRUE) %>%"
"0","  mutate(year = ""2009"") %>%"
"0","  filter(OFFENSE == ""THEFT/OTHER"")"
"0","  "
"0","crime19 <- "
"0","  read.csv(""/Users/kmlum/OneDrive/Documents/FALL 2021/Public Policy Analytics/GitHub/TODassignment/Crime_Incidents_in_2019.csv"", header = TRUE) %>%"
"0","  mutate(year = ""2019"") %>%"
"0","  filter(OFFENSE == ""THEFT/OTHER"")"
"0",""
"0","#sf objects"
"0","crime09.sf <- st_as_sf(crime09, coords = c(""LONGITUDE"", ""LATITUDE""), crs = 4326, agr = ""constant"") %>%"
"0","    st_transform(st_crs(allTracts.group))"
"0",""
"0","crime19.sf <- st_as_sf(crime19, coords = c(""LONGITUDE"", ""LATITUDE""), crs = 4326, agr = ""constant"") %>%"
"0","    st_transform(st_crs(allTracts.group))"
"0","  "
"0","#combine"
"0","crime_data <- rbind(crime09.sf,crime19.sf)"
"0",""
"0","#Plot Crime Data"
"0",""
"0","#2009 ACS Data Pull "
"0",""
"0","dcTracts09 <-  "
"0","  get_acs(geography = ""tract"", variable = c(""B25058_001E""),"
"0","                year=2009, state=11, county=001, geometry=T) %>%"
"0","  st_transform('ESRI:102685') %>%"
"0","  mutate(year = ""2009"")"
"2","Getting data from the 2005-2009 5-year ACS
"
"2","Downloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.
"
"0","  "
"0","dcTracts09 <- "
"0","  dcTracts09 %>%"
"0","  dplyr::select( -NAME, -moe) %>%"
"0","  spread(variable, estimate) %>%"
"0","  dplyr::select(-geometry) %>%"
"0","  rename(MedRent = B25058_001)"
"0","  "
"0","allTracts <- rbind(select(dcTracts00,year,GEOID, MedRent),dcTracts09,select(dcTracts19,year,GEOID,MedRent))"
"0",""
"0","allTracts.group <- "
"0","  rbind("
"0","    st_centroid(allTracts)[buffer,] %>%"
"0","      st_drop_geometry() %>%"
"0","      left_join(allTracts) %>%"
"0","      st_sf() %>%"
"0","      mutate(TOD = ""TOD""),"
"0","    st_centroid(allTracts)[buffer, op = st_disjoint] %>%"
"0","      st_drop_geometry() %>%"
"0","      left_join(allTracts) %>%"
"0","      st_sf() %>%"
"0","      mutate(TOD = ""Non-TOD"")) %>%"
"0","  mutate(MedRent.inf = ifelse(year == ""2000"", MedRent * 1.4847, MedRent)) %>%"
"0","  mutate(MedRent.inf = ifelse(year == ""2009"", MedRent * 1.1917, MedRent))"
"1","Joining, by = c(""year"", ""GEOID"", ""MedRent"")
"
"1","Joining, by = c(""year"", ""GEOID"", ""MedRent"")
"
"0","  "
"0","ggplot()+"
"0","    scale_fill_manual(values = palette5,"
"0","                      labels = qBr(allTracts.group, ""MedRent.inf""),"
"0","                      name = ""Rent\n(Quintile Breaks)"") +"
"0","    geom_sf(data=allTracts.group, aes(fill = q5(MedRent.inf))) +"
"0","    geom_sf(data=crime_data, show.legend = ""point"", size=0.02, color = ""darkblue"")+ "
"0","    geom_sf(data = buffer, fill = ""transparent"", color = ""red"")+"
"0","    labs(title = ""Theft and Rent in TOD vs. Non-TOD Areas"", subtitle = ""Real Dollars, The red border denotes areas close to metro stations, Dots are Theft Incidents"", caption = ""Figure 4.1"") +"
"0","    facet_wrap(~year)+"
"0","    mapTheme() + "
"0","    theme(plot.title = element_text(size=15))"
"0",""
